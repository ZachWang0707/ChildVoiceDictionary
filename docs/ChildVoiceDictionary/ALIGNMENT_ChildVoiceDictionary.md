# ALIGNMENT - 儿童语音英语查词应用

## 项目上下文分析

### 现有项目状态
- 项目名称：ChildVoiceDictionary
- 目录状态：已有初步实现，正在迭代优化
- 技术栈：React + Vite（前端）+ Node.js（后端）
- 部署目标：Vercel（前端 + Serverless Functions 后端）

### 项目特性规范
- 面向用户：7岁中国儿童
- 交互方式：语音为主，视觉为辅
- 核心功能：英语单词查询、语音识别、语音合成、生词表管理
- 架构模式：**意图驱动架构（Intent-Driven）**，不再使用传统状态机

---

## 原始需求（更新版）

### 技术栈
- 前端：React + Vite
- 后端：Vercel Serverless Functions（仅用于必须后端处理的部分）
- 数据库：第一版不使用数据库
- 部署目标：Vercel
- 不需要任何 UI 组件库，样式用原生 CSS 即可，保持简单

### 核心功能（更新版 - 意图驱动）
这是一个给7岁孩子用的英语查词工具，孩子通过语音输入单词，App 用语音播报释义。尽量减少孩子看屏幕。

**交互理念（重大更新）：**
- 不再使用死板的状态机控制流程
- 改为 LLM 意图驱动的灵活交互
- 用户可以以任何方式表达意图

**用户可能的输入类型：**
1. **直接说单词**：如 "camping"，甚至可能念了不止一遍。
2. **直接说拼写**：如 "C A M P I N G"
3. **带上下文的话语**：如 "我有一个单词不认识，你可以告诉我是什么意思么？这个词是 camping"，“我问个词啊， C A M P I N G”；
4. **直接要求加词**：如 "我想往生词表里加一个词，可以么？这个词是 XXX"
5. **回答问题**：如 "要"、"不要"、"好的"、"可以"
6. **无关的聊天**：如 "你好"、"今天天气真好"、“你在么”、“你可以跟我讲讲XXX么”

**系统响应逻辑：**
1. **识别到单词（无论读或拼写）**：提取单词，找用户确认
2. **识别到回答问题**：顺着之前的逻辑继续
3. **确认单词后**：给出释义（读音、词性、含义、举例），询问是否加入生词表
4. **识别到无关内容**：回应两句，然后把主题拉回查词

### 打断机制
- 用户按住说话按钮时，立即停止当前播报
- 逻辑上视为播报已完成
- 用户可以随时打断

### 释义内容（更新版）
包含以下要素：
1. **读音**：单词的标准发音
2. **词性**：如名词、动词等
3. **含义**：简洁的中文解释
4. **举例**：一个简短、利于孩子理解的例句

### 生词表功能
- 加入生词表的词存储在 localStorage（前端）
- 页面上有一个入口可以查看生词表

### 后端功能
- 阿里云 ASR 对接（HTTP RESTful API）
- 火山引擎 TTS 对接（HTTP）
- 火山方舟 LLM 对接（HTTP）- 用于意图理解和单词释义

### LLM 用途（重大更新）
LLM 现在用于两个场景：
1. **意图理解**：理解用户每一句话的意图，提取关键信息
2. **单词释义**：生成单词的详细解释

---

## 边界确认

### 任务范围（更新版）
✅ 包含：
- 前端项目初始化（React + Vite）
- 后端项目初始化（Vercel Serverless Functions）
- 后端对接阿里云 ASR（HTTP RESTful API）
- 后端对接火山引擎 TTS（HTTP）
- 后端对接火山方舟 LLM（HTTP）
- **意图驱动的交互架构**（新）
- **LLM 意图理解**（新）
- **用户打断机制**（新）
- **完整释义（读音+词性+含义+举例）**（新）
- 前端语音交互流程实现
- 前端基础 UI 实现
- 生词表功能（localStorage 存储）
- 环境变量配置

❌ 不包含（第一版）：
- 数据库（Turso/SQLite 等）
- 完整的交互数据记录
- 用户登录/注册（第二版）
- 单词复习功能（第二版）
- 生词表的复杂管理（编辑、删除、分类等）
- 单词发音的国际音标显示
- 复杂动画效果
- 单元测试（后续可补充）

---

## 需求理解（更新版）

### 对现有项目的理解
- 已有初步实现，现在迭代为意图驱动架构
- 从传统状态机思维 → LLM 意图驱动思维
- 后端负责：API 对接、LLM 意图理解、单词释义
- 前端负责：UI、录音、播放、打断机制、生词表存储
- 目标用户明确：7岁中国儿童，需要特别考虑易用性

### 技术选型理解
- 前端：React + Vite
- 后端：Vercel Serverless Functions（Node.js）
- ASR：阿里云智能语音交互（HTTP RESTful API）
- TTS：火山引擎豆包语音（HTTP API）
- LLM：火山方舟豆包大模型（OpenAI 兼容接口）
- LLM 双重用途：意图理解 + 单词释义

---

## 疑问澄清

### 已确认的问题
1. **架构模式**：从状态机改为 LLM 意图驱动
2. **打断机制**：前端实现，按下按钮即停止播报
3. **释义内容**：读音 + 词性 + 含义 + 举例
4. **文档更新**：所有相关文档同步更新
5. **用户输入方式**：完全开放，LLM 负责理解意图
